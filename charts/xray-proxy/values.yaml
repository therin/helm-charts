# Deployment settings
replicaCount: 1

image:
  repository: teddysun/xray
  tag: "1.8.24"
  pullPolicy: IfNotPresent

# Service configuration
service:
  type: LoadBalancer
  socks5Port: 1080
  realityPort: 443

# Resource limits
# resources:
#   limits:
#     cpu: 500m
#     memory: 512Mi
#   requests:
#     cpu: 100m
#     memory: 128Mi

# Node selector and tolerations
nodeSelector: {}
tolerations: []
affinity: {}

# Security context
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000

# Pod security context
podSecurityContext:
  fsGroup: 1000

# Monitoring (optional)
monitoring:
  enabled: false
  port: 8080

# Based on examples from https://github.com/XTLS/Xray-examples
xrayConfig: |
  {
    "log": {
      "loglevel": "info"
    },
    "inbounds": [
      {
        "tag": "socks5",
        "port": 1080,
        "protocol": "socks",
        "settings": {
          "auth": "noauth",
          "udp": true
        }
      },
      {
        "tag": "vless-reality",
        "port": 443,
        "protocol": "vless",
        "settings": {
          "clients": [
            {
              "id": "REPLACE_WITH_YOUR_UUID",
              "flow": "xtls-rprx-vision"
            }
          ],
          "decryption": "none"
        },
        "streamSettings": {
          "network": "tcp",
          "security": "reality",
          "realitySettings": {
            "show": false,
            "dest": "www.microsoft.com:443",
            "xver": 0,
            "serverNames": [
              "www.microsoft.com"
            ],
            "privateKey": "REPLACE_WITH_YOUR_PRIVATE_KEY",
            "shortIds": [
              "REPLACE_WITH_SHORT_ID"
            ]
          }
        }
      }
    ],
    "outbounds": [
      {
        "protocol": "freedom",
        "tag": "direct"
      }
    ],
    "routing": {
      "rules": [
        {
          "type": "field",
          "inboundTag": ["socks5", "vless-reality"],
          "outboundTag": "direct"
        }
      ]
    }
  }