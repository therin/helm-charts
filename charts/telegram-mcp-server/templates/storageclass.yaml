{{- if and .Values.persistence.enabled .Values.persistence.createStorageClass }}
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: {{ .Values.persistence.storageClass }}
  labels:
    {{- include "telegram-mcp-server.labels" . | nindent 4 }}
provisioner: driver.longhorn.io
reclaimPolicy: Retain  # Keep PV data even if PVC is deleted
allowVolumeExpansion: true
volumeBindingMode: Immediate
parameters:
  numberOfReplicas: "{{ .Values.persistence.longhorn.replicas | default 2 }}"
  staleReplicaTimeout: "2880"
  dataLocality: "best-effort"  # Keep replica on same node as pod for better performance
{{- end }}
